#ifndef DPAUCS_DHCP_H
#define DPAUCS_DHCP_H

#define DHCP_OPTION_MAGIC 0x63, 0x82, 0x53, 0x63
#define DHCP_OPTION_PADDING 0x0
#define DHCP_OPTION_END 0xFF
#define DHCP_OPTION( CODE, ... ) DHCP_OPTION_ ## CODE, sizeof((uint8_t[]){__VA_ARGS__}), __VA_ARGS__

typedef struct packed {
  uint8_t op, htype, hlen, hops;
  uint32_t xid;
  uint16_t secs, flags;
  uint8_t ciaddr[4];
  uint8_t yiaddr[4];
  uint8_t siaddr[4];
  uint8_t giaddr[4];
  uint8_t chaddr[16];
} DPAUCS_dhcp_t;

enum dhcp_op {
  DHCP_OP_BOOT_REQUEST = 1,
  DHCP_OP_BOOT_REPLY
};

enum dhcp_flags {
  DHCP_FLAG_BROADCAST = 15
};

enum dhcp_message_types {
  DHCP_MESSAGE_TYPE_DHCPDISCOVER = 1,
  DHCP_MESSAGE_TYPE_DHCPOFFER,
  DHCP_MESSAGE_TYPE_DHCPREQUEST,
  DHCP_MESSAGE_TYPE_DHCPDECLINE,
  DHCP_MESSAGE_TYPE_DHCPACK,
  DHCP_MESSAGE_TYPE_DHCPNAK,
  DHCP_MESSAGE_TYPE_DHCPRELEASE
};

enum dhcp_options {
  DHCP_OPTION_SUBNET_MASK = 1,
  DHCP_OPTION_TIME_OFFSET,
  DHCP_OPTION_ROUTER,
  DHCP_OPTION_TIME_SERVER,
  DHCP_OPTION_NAME_SERVER,
  DHCP_OPTION_DOMAIN_NAME_SERVER,
  DHCP_OPTION_LOG_SERVER,
  DHCP_OPTION_COOKIE_SERVER,
  DHCP_OPTION_LPR_SERVER,
  DHCP_OPTION_IMPRESS_SERVER,
  DHCP_OPTION_RESOURCE_LOCATION_SERVER,
  DHCP_OPTION_HOST_NAME,
  DHCP_OPTION_BOOT_FILE_SIZE,
  DHCP_OPTION_MERIT_DUMP_FILE,
  DHCP_OPTION_DOMAIN_NAME,
  DHCP_OPTION_SWAP_SERVER,
  DHCP_OPTION_ROOT_PATH,
  DHCP_OPTION_EXTENSIONS_PATH,
  DHCP_OPTION_IP_FORWARDING_ENABLE_DISABLE,
  DHCP_OPTION_NONLOCAL_SOURCE_ROUTING_ENABLE_DISABLE,
  DHCP_OPTION_POLICY_FILTER,
  DHCP_OPTION_MAXIMUM_DATAGRAM_REASSEMBLY_SIZE,
  DHCP_OPTION_DEFAULT_IP_TIME_TO_LIVE,
  DHCP_OPTION_PATH_MTU_AGING_TIMEOUT,
  DHCP_OPTION_PATH_MTU_PLATEAU_TABLE,
  DHCP_OPTION_INTERFACE_MTU,
  DHCP_OPTION_ALL_SUBNETS_ARE_LOCAL,
  DHCP_OPTION_BROADCAST_ADDRESS,
  DHCP_OPTION_PERFORM_MASK_DISCOVERY,
  DHCP_OPTION_MASK_SUPPLIER,
  DHCP_OPTION_PERFORM_ROUTER_DISCOVERY,
  DHCP_OPTION_ROUTER_SOLICITATION_ADDRESS,
  DHCP_OPTION_STATIC_ROUTE,
  DHCP_OPTION_TRAILER_ENCAPSULATION,
  DHCP_OPTION_ARP_CACHE_TIMEOUT,
  DHCP_OPTION_ETHERNET_ENCAPSULATION,
  DHCP_OPTION_TCP_DEFAULT_TTL,
  DHCP_OPTION_TCP_KEEP_ALIVE_INTERVAL,
  DHCP_OPTION_TCP_KEEP_ALIVE_GARBAGE,
  DHCP_OPTION_NETWORK_INFORMATION_SERVICE_DOMAIN,
  DHCP_OPTION_NETWORK_INFORMATION_SERVERS,
  DHCP_OPTION_NETWORK_TIME_PROTOCOL_SERVERS,
  DHCP_OPTION_VENDOR_SPECIFIC_INFORMATION,
  DHCP_OPTION_NETBIOS_OVER_TCP_IP_NAME_SERVER,
  DHCP_OPTION_NETBIOS_OVER_TCP_IP_DATAGRAM_DISTRIBUTION_SERVER,
  DHCP_OPTION_NETBIOS_OVER_TCP_IP_NODE_TYPE,
  DHCP_OPTION_NETBIOS_OVER_TCP_IP_SCOPE,
  DHCP_OPTION_X_WINDOW_SYSTEM_FONT_SERVER,
  DHCP_OPTION_X_WINDOW_SYSTEM_DISPLAY_MANAGER,
  DHCP_OPTION_REQUEST_IP_ADDRESS,
  DHCP_OPTION_IP_ADDRESS_LEASE_TIME,
  DHCP_OPTION_OPTION_OVERLOAD,
  DHCP_OPTION_MESSAGE_TYPE,
  DHCP_OPTION_SERVER_IDENTIFIER,
  DHCP_OPTION_PARAMETER_REQUEST_LIST,
  DHCP_OPTION_MESSAGE,
  DHCP_OPTION_MAXIMUM_DHCP_MESSAGE_SIZE,
  DHCP_OPTION_RENEWAL_TIME_VALUE,
  DHCP_OPTION_REBINDING_TIME_VALUE,
  DHCP_OPTION_CLASS_IDENTIFIER,
  DHCP_OPTION_CLIENT_IDENTIFIER,
  DHCP_OPTION_NETWARE_IP_DOMAIN,
  DHCP_OPTION_NETWARE_IP_OPTION,
  DHCP_OPTION_NIS_DOMAIN_NAME,
  DHCP_OPTION_NIS_SERVER_ADDR,
  DHCP_OPTION_SERVER_NAME,
  DHCP_OPTION_BOOTFILE_NAME,
  DHCP_OPTION_HOME_AGENT_ADDRS,
  DHCP_OPTION_SMTP_SERVER,
  DHCP_OPTION_POP3_SERVER,
  DHCP_OPTION_NNTP_SERVER,
  DHCP_OPTION_WWW_SERVER,
  DHCP_OPTION_FINGER_SERVER,
  DHCP_OPTION_IRC_SERVER,
  DHCP_OPTION_STREETTALK_SERVER,
  DHCP_OPTION_STDA_SERVER,
  DHCP_OPTION_USER_CLASS,
  DHCP_OPTION_DIRECTORY_AGENT,
  DHCP_OPTION_SERVICE_SCOPE,
  DHCP_OPTION_RAPID_COMMIT,
  DHCP_OPTION_CLIENT_FQDN,
  DHCP_OPTION_RELAY_AGENT_INFORMATION,
  DHCP_OPTION_ISNS,
  DHCP_OPTION_NDS_SERVERS = 85,
  DHCP_OPTION_NDS_TREE_NAME,
  DHCP_OPTION_NDS_CONTEXT,
  DHCP_OPTION_BCMCS_CONTROLLER_DOMAIN_NAME_LIST,
  DHCP_OPTION_BCMCS_CONTROLLER_IPV4_ADDRESS,
  DHCP_OPTION_AUTHENTICATION,
  DHCP_OPTION_CLIENT_LAST_TRANSACTION_TIME,
  DHCP_OPTION_ASSOCIATED_IP,
  DHCP_OPTION_CLIENT_SYSTEM,
  DHCP_OPTION_CLIENT_NDI,
  DHCP_OPTION_LDAP,
  DHCP_OPTION_UUID_GUID = 97,
  DHCP_OPTION_USER_AUTH,
  DHCP_OPTION_GEOCONF_CIVIC,
  DHCP_OPTION_PCODE,
  DHCP_OPTION_TCODE,
  DHCP_OPTION_NETINFO_ADDRESS = 112,
  DHCP_OPTION_NETINFO_TAG,
  DHCP_OPTION_URL,
  DHCP_OPTION_AUTO_CONFIG = 116,
  DHCP_OPTION_NAME_SERVICE_SEARCH,
  DHCP_OPTION_SUBNET_SELECTION,
  DHCP_OPTION_DOMAIN_SEARCH,
  DHCP_OPTION_SIP_SERVERS_DHCP,
  DHCP_OPTION_CLASSLESS_STATIC_ROUTE,
  DHCP_OPTION_CCC,
  DHCP_OPTION_GEOCONF,
  DHCP_OPTION_V_I_VENDOR_CLASS,
  DHCP_OPTION_V_I_VENDOR_SPECIFIC_INFORMATION,
  DHCP_OPTION_ETHERBOOT_SIGNATURE_6_BYTES_E4_45_74_68_00_00 = 128,
  DHCP_OPTION_DOCSIS_FULL_SECURITY_SERVER_IP_ADDRESS = 128,
  DHCP_OPTION_TFTP_SERVER_IP_ADDRESS_FOR_IP_PHONE_SOFTWARE_LOAD = 128,
  DHCP_OPTION_KERNEL_OPTIONS_VARIABLE_LENGTH_STRING = 129,
  DHCP_OPTION_CALL_SERVER_IP_ADDRESS = 129,
  DHCP_OPTION_ETHERNET_INTERFACE_VARIABLE_LENGTH_STRING = 130,
  DHCP_OPTION_DISCRIMINATION_STRING_TO_IDENTIFY_VENDOR = 130,
  DHCP_OPTION_REMOTE_STATISTICS_SERVER_IP_ADDRESS,
  DHCP_OPTION_IEEE_802_1Q_VLAN_ID,
  DHCP_OPTION_IEEE_802_1D_P_LAYER_2_PRIORITY,
  DHCP_OPTION_DIFFSERV_CODE_POINT_DSCP_FOR_VOIP_SIGNALLING_AND_MEDIA_STREAMS,
  DHCP_OPTION_HTTP_PROXY_FOR_PHONE_SPECIFIC_APPLICATIONS,
  DHCP_OPTION_OPTION_PANA_AGENT,
  DHCP_OPTION_OPTION_V4_LOST,
  DHCP_OPTION_OPTION_CAPWAP_AC_V4,
  DHCP_OPTION_OPTION_IPV4_ADDRESS_MOS,
  DHCP_OPTION_OPTION_IPV4_FQDN_MOS,
  DHCP_OPTION_SIP_UA_CONFIGURATION_SERVICE_DOMAINS,
  DHCP_OPTION_OPTION_IPV4_ADDRESS_ANDSF,
  DHCP_OPTION_GEOLOC = 144,
  DHCP_OPTION_FORCERENEW_NONCE_CAPABLE,
  DHCP_OPTION_RDNSS_SELECTION,
  DHCP_OPTION_TFTP_SERVER_ADDRESS = 150,
  DHCP_OPTION_ETHERBOOT = 150,
  DHCP_OPTION_GRUB_CONFIGURATION_PATH_NAME = 150,
  DHCP_OPTION_STATUS_CODE,
  DHCP_OPTION_BASE_TIME,
  DHCP_OPTION_START_TIME_OF_STATE,
  DHCP_OPTION_QUERY_START_TIME,
  DHCP_OPTION_QUERY_END_TIME,
  DHCP_OPTION_DHCP_STATE,
  DHCP_OPTION_DATA_SOURCE,
  DHCP_OPTION_OPTION_V4_PCP_SERVER,
  DHCP_OPTION_OPTION_V4_PORTPARAMS,
  DHCP_OPTION_DHCP_CAPTIVE_PORTAL,
  DHCP_OPTION_OPTION_MUD_URL_V4_TEMPORARY_REGISTERED_2016_11_17_EXPIRES_2017_11_17_,
  DHCP_OPTION_PXELINUX_MAGIC = 208,
  DHCP_OPTION_CONFIGURATION_FILE,
  DHCP_OPTION_PATH_PREFIX,
  DHCP_OPTION_REBOOT_TIME,
  DHCP_OPTION_OPTION_6RD,
  DHCP_OPTION_OPTION_V4_ACCESS_DOMAIN,
  DHCP_OPTION_SUBNET_ALLOCATION_OPTION = 220,
  DHCP_OPTION_VIRTUAL_SUBNET_SELECTION_VSS_OPTION
};

#endif
